(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-3ad2"],{"/Bgb":function(e,t,o){"use strict";var l=o("N6Zh");o.n(l).a},CFgG:function(e,t,o){"use strict";o.r(t);var l=o("zF5t"),r=o("N4Yp"),i=o("t3Un"),a=function(e){return Object(i.a)({url:"/roleAuth/authList/"+e,method:"get"})},n=function(e){return Object(i.a)({url:"/roleAuth/update",method:"put",data:e})},s={data:function(){return{permission:this.$store.getters.auths,roleTree:[],defaultProps:{children:"list",label:"roleName"},authProps:{children:"list",label:"authName"},dialogTitle:"添加角色",dialogFormVisible:!1,dialogAuth:!1,role:{roleName:"",roleFather:"",roleIndex:null,roleComment:""},authTree:[],roleList:[],checkIds:[],checkRole:"",roleAuths:[]}},methods:{deleteById:function(e){var t=this;this.$confirm("确定删除这条记录?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then(function(){l.a.delete(e).then(function(e){200==e.code?(t.$message({message:e.msg,type:"success"}),t.treeList()):t.$message.error("删除失败")})})},treeList:function(){var e=this;this.$store.commit("SET_LOADING",!0),l.a.treeList().then(function(t){200==t.code&&(e.roleTree=t.data)})},all:function(){var e=this;l.a.all().then(function(t){200==t.code&&(e.roleList=t.data)})},toAdd:function(){this.dialogTitle="添加角色",this.role.roleId="",this.dialogFormVisible=!0},save:function(){var e=this;""!=this.role.roleId?l.a.update(this.role).then(function(t){200==t.code&&(e.$message.success(t.msg),e.dialogFormVisible=!1,e.treeList())}):l.a.save(this.role).then(function(t){200==t.code&&(e.$message.success(t.msg),e.dialogFormVisible=!1,e.treeList())})},toUpdate:function(e){var t=this;l.a.get(e).then(function(e){t.role=e.data,t.dialogTitle="修改角色",t.dialogFormVisible=!0})},toAuth:function(e){var t=this;this.checkRole=e,this.roleAuths=[],this.dialogAuth=!0,this.$nextTick(function(){t.$refs.tree.setCheckedKeys([])}),a(e).then(function(e){200==e.code&&(t.checkIds=e.data,t.checkIds.forEach(function(e,o){t.roleAuths.push({raRole:t.checkRole,raAuth:e})}))})},updateAuth:function(){var e=this;this.$store.commit("SET_LOADING",!0),n(this.roleAuths).then(function(t){200==t.code&&(e.$message.success(t.msg),e.dialogAuth=!1)})},handleCheckChange:function(e,t,o){var l=this.roleAuths.findIndex(function(t){return t.raAuth==e.authId});t&&-1===l&&this.roleAuths.push({raRole:this.checkRole,raAuth:e.authId}),t||-1===l||this.roleAuths.splice(l,1)},authTreeList:function(){var e=this;r.a.treeList().then(function(t){200==t.code&&(e.authTree=t.data)})}},created:function(){this.treeList(),this.all(),this.authTreeList()}},c=(o("/Bgb"),o("ZrdR")),d=Object(c.a)(s,function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[e.permission.indexOf("ar:role:add")>=0?o("div",{staticClass:"table-header"},[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.toAdd}},[e._v("添加")])],1):e._e(),e._v(" "),o("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:this.$store.getters.loading,expression:"this.$store.getters.loading"}],attrs:{data:e.roleTree,props:e.defaultProps,"show-checkbox":"","node-key":"roleId","default-expand-all":"","expand-on-click-node":!1},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.node,r=t.data;return o("span",{staticStyle:{flex:"1",display:"flex","align-items":"center","justify-content":"space-between","font-size":"16px","padding-right":"8px"}},[o("span",[o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:r.roleComment,placement:"top"}},[o("span",{staticStyle:{"font-size":"14px"}},[e._v(e._s(l.label))])])],1),e._v(" "),o("span",[e.permission.indexOf("ar:role:auth")>=0?o("el-button",{staticStyle:{"font-size":"12px",color:"#409eff"},attrs:{type:"text"},on:{click:function(t){e.toAuth(r.roleId)}}},[e._v("分配权限")]):e._e(),e._v(" "),e.permission.indexOf("ar:role:update")>=0?o("el-button",{staticStyle:{"font-size":"12px",color:"green"},attrs:{type:"text"},on:{click:function(t){e.toUpdate(r.roleId)}}},[e._v("修改")]):e._e(),e._v(" "),e.permission.indexOf("ar:role:delete")>=0?o("el-button",{staticStyle:{"font-size":"12px",color:"red"},attrs:{type:"text"},on:{click:function(t){e.deleteById(r.roleId)}}},[e._v("删除")]):e._e()],1)])}}])}),e._v(" "),o("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:this.$store.getters.loading,expression:"this.$store.getters.loading"}],attrs:{title:e.dialogTitle,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[o("el-form",{attrs:{model:e.role,"label-width":"80px",size:"mini"}},[o("el-form-item",{attrs:{label:"角色名"}},[o("el-input",{attrs:{clearable:""},model:{value:e.role.roleName,callback:function(t){e.$set(e.role,"roleName",t)},expression:"role.roleName"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"排序值"}},[o("el-input",{attrs:{clearable:""},model:{value:e.role.roleIndex,callback:function(t){e.$set(e.role,"roleIndex",t)},expression:"role.roleIndex"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"父级角色"}},[o("el-select",{attrs:{filterable:"",placeholder:"请选择",clearable:""},model:{value:e.role.roleFather,callback:function(t){e.$set(e.role,"roleFather",t)},expression:"role.roleFather"}},e._l(e.roleList,function(e){return o("el-option",{key:e.roleId,attrs:{label:e.roleName,value:e.roleId}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{attrs:{clearable:""},model:{value:e.role.roleComment,callback:function(t){e.$set(e.role,"roleComment",t)},expression:"role.roleComment"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("提交")]),e._v(" "),o("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")])],1)],1)],1),e._v(" "),o("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:this.$store.getters.loading,expression:"this.$store.getters.loading"}],attrs:{title:"权限分配",visible:e.dialogAuth},on:{"update:visible":function(t){e.dialogAuth=t}}},[o("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:this.$store.getters.loading,expression:"this.$store.getters.loading"}],ref:"tree",attrs:{data:e.authTree,props:e.authProps,"show-checkbox":"","node-key":"authId","expand-on-click-node":!1,"default-expand-all":"","default-checked-keys":e.checkIds,"default-expanded-keys":e.checkIds},on:{"check-change":e.handleCheckChange}}),e._v(" "),o("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.updateAuth}},[e._v("提交")]),e._v(" "),o("el-button",{attrs:{size:"mini"},on:{click:function(t){e.dialogAuth=!1}}},[e._v("取消")])],1)],1)},[],!1,null,"3a0d65d2",null);d.options.__file="RoleList.vue";t.default=d.exports},N4Yp:function(e,t,o){"use strict";var l=o("t3Un");t.a={treeList:function(){return Object(l.a)({url:"/auth/treeList",method:"get"})}}},N6Zh:function(e,t,o){},zF5t:function(e,t,o){"use strict";var l=o("t3Un");t.a={save:function(e){return Object(l.a)({url:"/role/add",method:"post",data:e})},update:function(e){return Object(l.a)({url:"/role/update",method:"put",data:e})},all:function(){return Object(l.a)({url:"/role/all",method:"get"})},treeList:function(){return Object(l.a)({url:"/role/treeList",method:"get"})},get:function(e){return Object(l.a)({url:"/role/get/"+e,method:"get"})},delete:function(e){return Object(l.a)({url:"/role/delete/"+e,method:"delete"})}}}}]);