(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2c3c"],{BYLi:function(e,t,i){"use strict";var n=i("jGsI");i.n(n).a},ISpm:function(e,t,i){},QESg:function(e,t,i){"use strict";i.r(t);var n=i("t3Un"),o=function(e){return Object(n.a)({url:"/completion/add",method:"post",data:e})},a=function(e){return Object(n.a)({url:"/completion/list",method:"post",data:e})},s=function(e){return Object(n.a)({url:"/completion/delete/"+e,method:"delete"})},l=function(e){return Object(n.a)({url:"/completion/get/"+e,method:"get"})},r=function(e){return Object(n.a)({url:"/completion/update",method:"put",data:e})},c={components:{Tinymce:i("glbJ").a},watch:{"completion.compTitle":function(e,t){this.checkComp()}},data:function(){return{tinymce:{type:1,dialogTinymceVisible:!1,tempValue:"",tempObj:{}},permission:this.$store.getters.auths,dialogTitle:"添加题目",dialogFormVisible:!1,page:{currentPage:1,currentCount:10,totalCount:null,totalPage:null,sortName:"",sortOrder:"asc",params:{bankId:this.$route.query.bankId,knowId:this.$route.query.knowId},list:[]},completion:{compId:"",compTitle:"",compScore:0,compDifficulty:1,compBank:this.$route.query.bankId,compKnow:this.$route.query.knowId,compResolve:"",answerList:[]},answerKey:0,answerCount:0}},methods:{toAdd:function(){this.completion.compId="",this.dialogFormVisible=!0,this.dialogTitle="添加题目",this.$alert("填空题三个以上下划线为一个空，输入下划线的方法是在英文状态下按住shift+_，下划线键在键盘上方0右边")},save:function(){var e=this;""==this.completion.compId?(this.$store.commit("SET_LOADING",!0),o(this.completion).then(function(t){200==t.code&&(e.$message.success(t.msg),e.list(),e.dialogFormVisible=!1)})):(this.$store.commit("SET_LOADING",!0),r(this.completion).then(function(t){200==t.code&&(e.$message.success(t.msg),e.list(),e.dialogFormVisible=!1)}))},list:function(){var e=this;this.$store.commit("SET_LOADING",!0),a(this.page).then(function(t){200==t.code&&(e.page=t.data)})},toUpdate:function(e){var t=this;this.dialogTitle="修改题目",this.dialogFormVisible=!0,l(e).then(function(e){200==e.code&&(t.completion=e.data,t.answerCount=e.data.answerList.length,t.answerKey=e.data.answerList.length,console.log(e.data.answerList.length))}),this.$alert("填空题三个以上下划线为一个空，输入下划线的方法是在英文状态下按住shift+_，下划线键在键盘上方0右边")},deleteById:function(e){var t=this;this.$confirm("确定从题库中删除本题吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then(function(){s(e).then(function(e){200==e.code&&(t.$message.success(e.msg),t.list())})})},lookResolve:function(e){this.$alert(e.compResolve,"答案解析",{dangerouslyUseHTMLString:!0})},handleSizeChange:function(e){this.page.currentCount=e,this.list()},handleCurrentChange:function(e){this.page.currentPage=e,this.list()},removeAnswer:function(){this.answerKey=this.answerKey-1,this.completion.answerList.splice(this.completion.answerList.length-1,1)},addAnswer:function(){this.answerKey+=1;var e=this.answerKey;this.completion.answerList.push({answerId:e,answerContent:"",answerNumber:e})},checkComp:function(){var e=0,t=this.completion.compTitle,i=t.indexOf("___");for(i>-1&&(e++,t=(t=t.replace("___","")).substring(i,t.length));i>-1;)(i=t.indexOf("___"))>0&&e++,t=(t=t.replace("___","")).substring(i,t.length);var n=e-this.answerCount;if(n>0)for(var o=0;o<n;o++)this.addAnswer();else for(var a=0;a>n;a--)this.removeAnswer();this.answerCount=e},initTinymce:function(e,t){this.tinymce.type=t;var i="";1===t?i=e.compTitle:2===t&&(i=e.compResolve),this.tinymce.tempObj=e,this.tinymce.dialogTinymceVisible=!0,this.$refs.editor.setContent(i)},updateTinymceData:function(){var e=this.$refs.editor.getContent(),t=this.tinymce.type;1===t?this.completion.compTitle=e:2===t&&(this.completion.compResolve=e),this.tinymce.dialogTinymceVisible=!1}},created:function(){this.list(),this.tinymce.dialogTinymceVisible=!0},mounted:function(){this.tinymce.dialogTinymceVisible=!1}},m=(i("BYLi"),i("ZrdR")),u=Object(m.a)(c,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"table-header"},[i("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.page,size:"mini"}},[i("el-form-item",{attrs:{label:"题干"}},[i("el-input",{attrs:{placeholder:"题干",clearable:""},model:{value:e.page.params.title,callback:function(t){e.$set(e.page.params,"title",t)},expression:"page.params.title"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"难度系数"}},[i("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请选择"},model:{value:e.page.params.difficulty,callback:function(t){e.$set(e.page.params,"difficulty",t)},expression:"page.params.difficulty"}},e._l(5,function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})}))],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.list}},[e._v("查询")])],1)],1),e._v(" "),i("el-divider"),e._v(" "),e.permission.indexOf("question:add")>=0?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.toAdd}},[e._v("添加")]):e._e()],1),e._v(" "),i("div",{directives:[{name:"loading",rawName:"v-loading",value:this.$store.getters.loading,expression:"this.$store.getters.loading"}]},e._l(e.page.list,function(t,n){return i("el-row",{key:t.tfId},[i("el-card",{staticClass:"card-box"},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("div",{staticClass:"question-content"},[i("div",{staticClass:"num-div"},[e._v(e._s(n+1+". "))]),e._v(" "),i("div",{staticClass:"content-div",domProps:{innerHTML:e._s(t.compTitle)}}),e._v(" "),i("div",{staticClass:"point-div"},[e._v(e._s(". ("+t.compScore+"分)"))])]),e._v(" "),i("el-dropdown",{staticStyle:{float:"right","margin-top":"8px"}},[i("el-button",{attrs:{type:"primary",size:"mini"}},[e._v("\n              操作\n              "),i("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",[e.permission.indexOf("question:update")>=0?i("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(i){e.toUpdate(t.compId)}}},[e._v("编辑")]):e._e()],1),e._v(" "),i("el-dropdown-item",[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(i){e.lookResolve(t)}}},[e._v("查看解析")])],1),e._v(" "),i("el-dropdown-item",[e.permission.indexOf("question:delete")>=0?i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){e.deleteById(t.compId)}}},[e._v("删除")]):e._e()],1)],1)],1)],1),e._v(" "),i("div",{staticClass:"bottom clearfix"},[i("div",{staticStyle:{"margin-top":"8px"}},[i("el-rate",{attrs:{disabled:"","show-score":"","allow-half":"","text-color":"#ff9900","score-template":"难度系数: {value}"},model:{value:t.compDifficulty,callback:function(i){e.$set(t,"compDifficulty",i)},expression:"question.compDifficulty"}})],1)])])],1)})),e._v(" "),i("div",{staticClass:"page-div banklist-page"},[i("el-pagination",{attrs:{"current-page":e.page.currentPage,"page-sizes":[5,10,15,20],"page-size":e.page.currentCount,layout:"total, sizes, prev, pager, next, jumper",total:e.page.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),i("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[i("el-form",{directives:[{name:"loading",rawName:"v-loading",value:this.$store.getters.loading,expression:"this.$store.getters.loading"}],attrs:{model:e.completion,"label-width":"80px",size:"mini"}},[i("el-form-item",{attrs:{label:"题目"}},[i("el-input",{model:{value:e.completion.compTitle,callback:function(t){e.$set(e.completion,"compTitle",t)},expression:"completion.compTitle"}},[i("el-button",{attrs:{slot:"append"},on:{click:function(t){e.initTinymce(e.completion,1)}},slot:"append"},[e._v("高级输入")])],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"分值"}},[i("el-input",{attrs:{clearable:""},model:{value:e.completion.compScore,callback:function(t){e.$set(e.completion,"compScore",t)},expression:"completion.compScore"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"难度系数"}},[i("el-rate",{attrs:{"show-score":"","text-color":"#ff9900","score-template":"{value}"},model:{value:e.completion.compDifficulty,callback:function(t){e.$set(e.completion,"compDifficulty",t)},expression:"completion.compDifficulty"}})],1),e._v(" "),e._l(e.completion.answerList,function(t){return i("el-form-item",{key:t.answerNumber,attrs:{label:"填空"+t.answerNumber}},[i("el-input",{attrs:{clearable:""},model:{value:t.answerContent,callback:function(i){e.$set(t,"answerContent",i)},expression:"answer.answerContent"}})],1)}),e._v(" "),i("el-form-item",{attrs:{label:"解析"}},[i("el-input",{model:{value:e.completion.compResolve,callback:function(t){e.$set(e.completion,"compResolve",t)},expression:"completion.compResolve"}},[i("el-button",{attrs:{slot:"append"},on:{click:function(t){e.initTinymce(e.completion,2)}},slot:"append"},[e._v("高级输入")])],1)],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("提交")]),e._v(" "),i("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")])],1)],2)],1),e._v(" "),i("el-dialog",{attrs:{visible:e.tinymce.dialogTinymceVisible},on:{"update:visible":function(t){e.$set(e.tinymce,"dialogTinymceVisible",t)}}},[i("tinymce",{ref:"editor",attrs:{height:300},model:{value:e.tinymce.tempValue,callback:function(t){e.$set(e.tinymce,"tempValue",t)},expression:"tinymce.tempValue"}}),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.tinymce.dialogTinymceVisible=!1}}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.updateTinymceData}},[e._v("确定")])],1)],1)],1)},[],!1,null,"2dd6553a",null);u.options.__file="CompletionList.vue";t.default=u.exports},glbJ:function(e,t,i){"use strict";var n=["advlist anchor autolink autosave code codesample colorpicker colorpicker contextmenu directionality emoticons fullscreen hr imagetools importcss insertdatetime link lists nonbreaking noneditable pagebreak preview print save searchreplace spellchecker tabfocus table template textcolor textpattern visualblocks visualchars wordcount"],o=["bold italic underline strikethrough alignleft aligncenter alignright outdent indent  blockquote undo redo removeformat subscript superscript code codesample","hr bullist numlist link image charmap preview anchor pagebreak insertdatetime media table emoticons forecolor backcolor fullscreen"],a=i("t3Un"),s=function(e){return Object(a.a)({url:"/upload",method:"post",data:e})},l={name:"Tinymce",props:{id:{type:String,default:function(){return"vue-tinymce-"+ +new Date+(1e3*Math.random()).toFixed(0)}},value:{type:String,default:""},toolbar:{type:Array,required:!1,default:function(){return[]}},menubar:{type:String,default:"file edit insert view format table"},height:{type:Number,required:!1,default:360}},data:function(){return{hasChange:!1,hasInit:!1,tinymceId:this.id,fullscreen:!1,languageTypeList:{en:"en",zh:"zh_CN"}}},computed:{language:function(){return this.languageTypeList.zh}},watch:{value:function(e){var t=this;!this.hasChange&&this.hasInit&&this.$nextTick(function(){return window.tinymce.get(t.tinymceId).setContent(e||"")})},language:function(){var e=this;this.destroyTinymce(),this.$nextTick(function(){return e.initTinymce()})}},mounted:function(){this.initTinymce()},destroyed:function(){this.destroyTinymce()},methods:{initTinymce:function(){window.tinymce.init({language:this.language,selector:"#"+this.tinymceId,toolbar:this.toolbar.length>0?this.toolbar:o,plugins:["powerpaste",n],object_resizing:!0,end_container_on_empty_block:!0,powerpaste_word_import:"merge",powerpaste_html_import:"merge",powerpaste_allow_local_images:!0,paste_retain_style_properties:"all",paste_word_valid_elements:"*[*]",paste_data_images:!0,paste_convert_word_fake_lists:!0,nonbreaking_force_tab:!0,images_upload_handler:function(e,t,i){var n=new FormData;n.append("file",e.blob()),s(n).then(function(e){console.log(e.data.fileUrl);var i=e.data.fileUrl;t(i)})}})},destroyTinymce:function(){window.tinymce.get(this.tinymceId)&&window.tinymce.get(this.tinymceId).destroy()},setContent:function(e){window.tinymce.get(this.tinymceId).setContent(e)},getContent:function(){return window.tinymce.get(this.tinymceId).getContent()}}},r=(i("v57J"),i("ZrdR")),c=Object(r.a)(l,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"tinymce-container editor-container",class:{fullscreen:this.fullscreen}},[t("textarea",{staticClass:"tinymce-textarea",attrs:{id:this.tinymceId}})])},[],!1,null,"77265664",null);c.options.__file="index.vue";t.a=c.exports},jGsI:function(e,t,i){},v57J:function(e,t,i){"use strict";var n=i("ISpm");i.n(n).a}}]);