(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-daf2"],{"1/L0":function(e,t,i){"use strict";i.r(t);var n=i("t3Un"),o=function(e){return Object(n.a)({url:"/code/add",method:"post",data:e})},a=function(e){return Object(n.a)({url:"/code/list",method:"post",data:e})},s=function(e){return Object(n.a)({url:"/code/delete/"+e,method:"delete"})},l=function(e){return Object(n.a)({url:"/code/get/"+e,method:"get"})},r=function(e){return Object(n.a)({url:"/code/update",method:"put",data:e})},c=function(){return Object(n.a)({url:"/compile/all",method:"get"})},d={components:{Tinymce:i("glbJ").a},data:function(){return{tinymce:{type:1,dialogTinymceVisible:!1,tempValue:"",tempObj:{}},permission:this.$store.getters.auths,dialogTitle:"添加题目",dialogFormVisible:!1,answerKey:1,page:{currentPage:1,currentCount:10,totalCount:null,totalPage:null,sortName:"",sortOrder:"asc",params:{typeId:this.$route.query.typeId,bankId:this.$route.query.bankId,knowId:this.$route.query.knowId,compileId:""},list:[]},compileList:[],code:{codeId:"",codeTitle:"",codeImg:"",codeType:this.$route.query.typeId,codeScore:0,codeCompile:null,codeDifficulty:1,codeBank:this.$route.query.bankId,codeKnow:this.$route.query.knowId,codeResolve:"",answerList:[{answerId:"",answerNumber:1,answerProblem:"",answerContent:"",answerScore:0}]}}},methods:{toAdd:function(){this.code.codeId="",this.dialogTitle="添加题目",this.dialogFormVisible=!0},save:function(){var e=this;""==this.code.codeId?(this.$store.commit("SET_LOADING",!0),o(this.code).then(function(t){200==t.code&&(e.$message.success(t.msg),e.dialogFormVisible=!1,e.list())})):(this.$store.commit("SET_LOADING",!0),r(this.code).then(function(t){200==t.code&&(e.$message.success(t.msg),e.dialogFormVisible=!1,e.list())}))},removeAnswer:function(e){var t=this.code.answerList.indexOf(e);if(-1!==t)if(t==this.answerKey)this.answerKey=this.answerKey-1,this.code.answerList.splice(t,1);else{var i=1;this.code.answerList.splice(t,1),this.code.answerList.forEach(function(e){e.answerNumber=i++}),i--,this.answerKey=i}},addAnswer:function(){this.answerKey=this.answerKey+1;var e=this.answerKey;this.code.answerList.push({answerId:e,answerContent:"",answerProblem:"",answerNumber:e,answerScore:0})},list:function(){var e=this;this.$store.commit("SET_LOADING",!0),a(this.page).then(function(t){200==t.code&&(e.page=t.data)})},lookResolve:function(e){var t="";e.answerList.forEach(function(e){t+='<div style="margin-bottom: 10px;"><p>（'+e.answerNumber+"）"+e.answerProblem+"</p><p>答案："+e.answerContent+"</p></div>"}),t+="<p>题目解析："+e.codeResolve+"</p>",this.$alert(t,"小题与解析",{dangerouslyUseHTMLString:!0})},handleSizeChange:function(e){this.page.currentCount=e,this.list()},handleCurrentChange:function(e){this.page.currentPage=e,this.list()},deleteById:function(e){var t=this;this.$confirm("确定删除这条记录?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then(function(){s(e).then(function(e){200==e.code&&(t.$message.success(e.msg),t.list())})})},toUpdate:function(e){var t=this;l(e).then(function(e){200==e.code&&(t.code=e.data,t.dialogTitle="修改题目",t.dialogFormVisible=!0,t.answerKey=e.data.answerList.length)})},getCompile:function(){var e=this;c().then(function(t){e.compileList=t.data})},initTinymce:function(e,t){this.tinymce.type=t;var i="";1===t?i=e.codeTitle:2===t?i=e.answerProblem:3===t?i=e.answerContent:4===t&&(i=e.codeResolve),this.tinymce.tempObj=e,this.tinymce.dialogTinymceVisible=!0,this.$refs.editor.setContent(i)},updateTinymceData:function(){var e=this.$refs.editor.getContent(),t=this.tinymce.type;if(1===t)this.code.codeTitle=e;else if(2===t){var i=this.tinymce.tempObj.answerNumber;this.code.answerList.filter(function(e){return e.answerNumber==i})[0].answerProblem=e}else if(3===t){var n=this.tinymce.tempObj.answerNumber;this.code.answerList.filter(function(e){return e.answerNumber==n})[0].answerContent=e}else 4===t&&(this.code.codeResolve=e);this.tinymce.dialogTinymceVisible=!1}},created:function(){this.list(),this.getCompile(),this.tinymce.dialogTinymceVisible=!0},mounted:function(){this.tinymce.dialogTinymceVisible=!1}},u=(i("Wxd6"),i("ZrdR")),m=Object(u.a)(d,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"table-header"},[i("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.page,size:"mini"}},[i("el-form-item",{attrs:{label:"题干"}},[i("el-input",{attrs:{placeholder:"题干",clearable:""},model:{value:e.page.params.title,callback:function(t){e.$set(e.page.params,"title",t)},expression:"page.params.title"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"难度系数"}},[i("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请选择"},model:{value:e.page.params.difficulty,callback:function(t){e.$set(e.page.params,"difficulty",t)},expression:"page.params.difficulty"}},e._l(5,function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})}))],1),e._v(" "),i("el-form-item",{attrs:{label:"编译器"}},[i("el-select",{attrs:{filterable:"",placeholder:"请选择",clearable:""},model:{value:e.page.params.compileId,callback:function(t){e.$set(e.page.params,"compileId",t)},expression:"page.params.compileId"}},e._l(e.compileList,function(e){return i("el-option",{key:e.compileId,attrs:{label:e.compileName,value:e.compileId}})}))],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.list}},[e._v("查询")])],1)],1),e._v(" "),i("el-divider"),e._v(" "),e.permission.indexOf("question:add")>=0?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.toAdd}},[e._v("添加")]):e._e()],1),e._v(" "),i("div",{directives:[{name:"loading",rawName:"v-loading",value:this.$store.getters.loading,expression:"this.$store.getters.loading"}]},e._l(e.page.list,function(t,n){return i("el-row",{key:t.codeId},[i("el-card",{staticClass:"card-box"},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("div",{staticStyle:{float:"left","padding-top":"10px","line-height":"10px"}},[i("div",{staticClass:"num-div"},[e._v(e._s(n+1+". "))]),e._v(" "),i("div",{staticClass:"content-div",domProps:{innerHTML:e._s(t.codeTitle)}}),e._v(" "),i("div",{staticClass:"point-div"},[e._v(e._s(". ("+t.codeScore+"分)"))])]),e._v(" "),i("el-dropdown",{staticStyle:{float:"right","margin-top":"8px"}},[i("el-button",{attrs:{type:"primary",size:"mini"}},[e._v("\n              操作\n              "),i("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",[e.permission.indexOf("question:update")>=0?i("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(i){e.toUpdate(t.codeId)}}},[e._v("编辑")]):e._e()],1),e._v(" "),i("el-dropdown-item",[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(i){e.lookResolve(t)}}},[e._v("解析")])],1),e._v(" "),i("el-dropdown-item",[e.permission.indexOf("question:delete")>=0?i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){e.deleteById(t.codeId)}}},[e._v("删除")]):e._e()],1)],1)],1)],1),e._v(" "),e._l(t.answerList,function(t){return i("div",{key:t.answerId,staticClass:"item",domProps:{innerHTML:e._s(t.answerNumber+". "+t.answerProblem)}})}),e._v(" "),i("div",{staticClass:"compile-item"},[e._v("编译器："+e._s(t.compileDO.compileName))]),e._v(" "),i("div",{staticClass:"bottom clearfix"},[i("div",{staticStyle:{"margin-top":"8px"}},[i("el-rate",{attrs:{disabled:"","show-score":"","allow-half":"","text-color":"#ff9900","score-template":"难度系数: {value}"},model:{value:t.codeDifficulty,callback:function(i){e.$set(t,"codeDifficulty",i)},expression:"code.codeDifficulty"}})],1)])],2)],1)})),e._v(" "),i("div",{staticClass:"page-div banklist-page"},[i("el-pagination",{attrs:{"current-page":e.page.currentPage,"page-sizes":[5,10,15,20],"page-size":e.page.currentCount,layout:"total, sizes, prev, pager, next, jumper",total:e.page.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),i("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[i("el-form",{directives:[{name:"loading",rawName:"v-loading",value:this.$store.getters.loading,expression:"this.$store.getters.loading"}],attrs:{model:e.code,"label-width":"80px",size:"mini"}},[i("el-form-item",{attrs:{label:"题目"}},[i("el-input",{model:{value:e.code.codeTitle,callback:function(t){e.$set(e.code,"codeTitle",t)},expression:"code.codeTitle"}},[i("el-button",{attrs:{slot:"append"},on:{click:function(t){e.initTinymce(e.code,1)}},slot:"append"},[e._v("高级输入")])],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"编译器"}},[i("el-select",{attrs:{filterable:"",placeholder:"请选择",clearable:""},model:{value:e.code.codeCompile,callback:function(t){e.$set(e.code,"codeCompile",t)},expression:"code.codeCompile"}},e._l(e.compileList,function(e){return i("el-option",{key:e.compileId,attrs:{label:e.compileName,value:e.compileId}})}))],1),e._v(" "),i("el-form-item",{attrs:{label:"难度系数"}},[i("el-rate",{attrs:{"show-score":"","text-color":"#ff9900","score-template":"{value}"},model:{value:e.code.codeDifficulty,callback:function(t){e.$set(e.code,"codeDifficulty",t)},expression:"code.codeDifficulty"}})],1),e._v(" "),e._l(e.code.answerList,function(t){return i("el-form-item",{key:t.answerNumber,attrs:{inline:!0,label:"小题"+t.answerNumber}},[i("div",{staticClass:"input-div"},[i("el-input",{staticStyle:{"max-width":"80%"},attrs:{placeholder:"请输入问题",clearable:""},model:{value:t.answerProblem,callback:function(i){e.$set(t,"answerProblem",i)},expression:"answer.answerProblem"}},[i("el-button",{attrs:{slot:"append"},on:{click:function(i){e.initTinymce(t,2)}},slot:"append"},[e._v("高级输入")])],1),e._v(" "),i("el-input",{attrs:{clearable:"",placeholder:"请输入分值"},model:{value:t.answerScore,callback:function(i){e.$set(t,"answerScore",i)},expression:"answer.answerScore"}}),e._v(" "),i("el-input",{staticStyle:{"max-width":"80%"},attrs:{placeholder:"请输入答案",clearable:""},model:{value:t.answerContent,callback:function(i){e.$set(t,"answerContent",i)},expression:"answer.answerContent"}},[i("el-button",{attrs:{slot:"append"},on:{click:function(i){e.initTinymce(t,3)}},slot:"append"},[e._v("高级输入")])],1)],1),e._v(" "),i("div",{staticClass:"delete-div"},[i("el-button",{attrs:{type:"danger"},on:{click:function(i){i.preventDefault(),e.removeAnswer(t)}}},[e._v("删除")])],1)])}),e._v(" "),i("el-form-item",{attrs:{label:"解析"}},[i("el-input",{model:{value:e.code.codeResolve,callback:function(t){e.$set(e.code,"codeResolve",t)},expression:"code.codeResolve"}},[i("el-button",{attrs:{slot:"append"},on:{click:function(t){e.initTinymce(e.code,4)}},slot:"append"},[e._v("高级输入")])],1)],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("提交")]),e._v(" "),i("el-button",{on:{click:e.addAnswer}},[e._v("添加小题")]),e._v(" "),i("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")])],1)],2)],1),e._v(" "),i("el-dialog",{attrs:{visible:e.tinymce.dialogTinymceVisible},on:{"update:visible":function(t){e.$set(e.tinymce,"dialogTinymceVisible",t)}}},[i("tinymce",{ref:"editor",attrs:{height:300},model:{value:e.tinymce.tempValue,callback:function(t){e.$set(e.tinymce,"tempValue",t)},expression:"tinymce.tempValue"}}),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.tinymce.dialogTinymceVisible=!1}}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.updateTinymceData}},[e._v("确定")])],1)],1)],1)},[],!1,null,"0bdd82c6",null);m.options.__file="CodeList.vue";t.default=m.exports},ISpm:function(e,t,i){},Wxd6:function(e,t,i){"use strict";var n=i("eaLu");i.n(n).a},eaLu:function(e,t,i){},glbJ:function(e,t,i){"use strict";var n=["advlist anchor autolink autosave code codesample colorpicker colorpicker contextmenu directionality emoticons fullscreen hr imagetools importcss insertdatetime link lists nonbreaking noneditable pagebreak preview print save searchreplace spellchecker tabfocus table template textcolor textpattern visualblocks visualchars wordcount"],o=["bold italic underline strikethrough alignleft aligncenter alignright outdent indent  blockquote undo redo removeformat subscript superscript code codesample","hr bullist numlist link image charmap preview anchor pagebreak insertdatetime media table emoticons forecolor backcolor fullscreen"],a=i("t3Un"),s=function(e){return Object(a.a)({url:"/upload",method:"post",data:e})},l={name:"Tinymce",props:{id:{type:String,default:function(){return"vue-tinymce-"+ +new Date+(1e3*Math.random()).toFixed(0)}},value:{type:String,default:""},toolbar:{type:Array,required:!1,default:function(){return[]}},menubar:{type:String,default:"file edit insert view format table"},height:{type:Number,required:!1,default:360}},data:function(){return{hasChange:!1,hasInit:!1,tinymceId:this.id,fullscreen:!1,languageTypeList:{en:"en",zh:"zh_CN"}}},computed:{language:function(){return this.languageTypeList.zh}},watch:{value:function(e){var t=this;!this.hasChange&&this.hasInit&&this.$nextTick(function(){return window.tinymce.get(t.tinymceId).setContent(e||"")})},language:function(){var e=this;this.destroyTinymce(),this.$nextTick(function(){return e.initTinymce()})}},mounted:function(){this.initTinymce()},destroyed:function(){this.destroyTinymce()},methods:{initTinymce:function(){window.tinymce.init({language:this.language,selector:"#"+this.tinymceId,toolbar:this.toolbar.length>0?this.toolbar:o,plugins:["powerpaste",n],object_resizing:!0,end_container_on_empty_block:!0,powerpaste_word_import:"merge",powerpaste_html_import:"merge",powerpaste_allow_local_images:!0,paste_retain_style_properties:"all",paste_word_valid_elements:"*[*]",paste_data_images:!0,paste_convert_word_fake_lists:!0,nonbreaking_force_tab:!0,images_upload_handler:function(e,t,i){var n=new FormData;n.append("file",e.blob()),s(n).then(function(e){console.log(e.data.fileUrl);var i=e.data.fileUrl;t(i)})}})},destroyTinymce:function(){window.tinymce.get(this.tinymceId)&&window.tinymce.get(this.tinymceId).destroy()},setContent:function(e){window.tinymce.get(this.tinymceId).setContent(e)},getContent:function(){return window.tinymce.get(this.tinymceId).getContent()}}},r=(i("v57J"),i("ZrdR")),c=Object(r.a)(l,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"tinymce-container editor-container",class:{fullscreen:this.fullscreen}},[t("textarea",{staticClass:"tinymce-textarea",attrs:{id:this.tinymceId}})])},[],!1,null,"77265664",null);c.options.__file="index.vue";t.a=c.exports},v57J:function(e,t,i){"use strict";var n=i("ISpm");i.n(n).a}}]);